# ๐ ุชูุซูู: ูุถุน ุงูุงุณุชุจุฏุงู ูุชุญุฏูุซ ูุญุชูู ุงูููู

## ๐ฏ ุงููุฏู
ุฅุถุงูุฉ ุฎูุงุฑ ููุชุญูู ูู ููููุฉ ุชุญุฏูุซ ูุญุชูู ุงูููู:
- **ุงุณุชุจุฏุงู (Replace)**: ุญุฐู ุงูููู ุงููุฏูู ููุถุน ุงูุฌุฏูุฏ ุจููุณ ุงูุงุณู ูุงููุณุงุฑ
- **ูุณุฎุฉ ุฌุฏูุฏุฉ (New)**: ุญุฐู ุงููุฏูู ูุฅูุดุงุก ููู ุฌุฏูุฏ ุจุงุณู ููุณุงุฑ ุฌุฏูุฏูู

## ๐ ุงูุชุนุฏููุงุช ุงููููุฐุฉ

### ุชุนุฏูู ุฏุงูุฉ `updateFileContent` ูู `services/fileService.js`

#### ุงูููุฒุงุช ุงูุฌุฏูุฏุฉ:

1. **ูุถุน ุงูุงุณุชุจุฏุงู ุงูุชููุงุฆู ูููููุงุช ุงููุตูุฉ:**
   - ุงููููุงุช ุงููุตูุฉ (`.txt`, `.md`, `.json`, `.xml`, `.csv` ูุบูุฑูุง) ูุชู ุงุณุชุจุฏุงููุง ุชููุงุฆูุงู
   - ูุชู ุงูุญูุงุธ ุนูู ููุณ ุงูุงุณู ูุงููุณุงุฑ

2. **ุฎูุงุฑ `replaceMode` ูููููุงุช ุงูุฃุฎุฑู:**
   - ูููู ูููุณุชุฎุฏู ุงุฎุชูุงุฑ ูุถุน ุงูุงุณุชุจุฏุงู ุนุจุฑ `replaceMode` ูู body
   - ุฅุฐุง ูุงู `replaceMode = true`: ุงุณุชุจุฏุงู ุงูููู ุงููุฏูู
   - ุฅุฐุง ูุงู `replaceMode = false` ุฃู ุบูุฑ ููุฌูุฏ: ุฅูุดุงุก ูุณุฎุฉ ุฌุฏูุฏุฉ

## ๐ ุณูุฑ ุงูุนูู

### 1. ูุถุน ุงูุงุณุชุจุฏุงู (Replace Mode)

**ูููููุงุช ุงููุตูุฉ (ุชููุงุฆู):**
- โ ุญุฐู ุงูููู ุงููุฏูู
- โ ูุณุฎ ุงูููู ุงูุฌุฏูุฏ ุฅูู ููุณ ุงูููุงู ุจููุณ ุงูุงุณู
- โ ุงูุญูุงุธ ุนูู ููุณ ุงูุงุณู ูุงููุณุงุฑ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช

**ูููููุงุช ุงูุฃุฎุฑู (ุนูุฏ `replaceMode = true`):**
- โ ุญุฐู ุงูููู ุงููุฏูู
- โ ูุณุฎ ุงูููู ุงูุฌุฏูุฏ ุฅูู ููุณ ุงูููุงู ุจููุณ ุงูุงุณู
- โ ุงูุญูุงุธ ุนูู ููุณ ุงูุงุณู ูุงููุณุงุฑ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช

### 2. ูุถุน ุงููุณุฎุฉ ุงูุฌุฏูุฏุฉ (New Version Mode)

**ูููููุงุช ุบูุฑ ุงููุตูุฉ (ุนูุฏ `replaceMode = false` ุฃู ุบูุฑ ููุฌูุฏ):**
- โ ุญุฐู ุงูููู ุงููุฏูู
- โ ุงูููู ุงูุฌุฏูุฏ ูุจูู ูู ููุงูู ุงูุฌุฏูุฏ (ูุน timestamp)
- โ ุชุญุฏูุซ ุงูุงุณู ูุงููุณุงุฑ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช

## ๐ API Usage

### 1. ุชุญุฏูุซ ููู ูุตู (ุงุณุชุจุฏุงู ุชููุงุฆู)

```http
PUT /api/files/:id/content
Content-Type: multipart/form-data
Authorization: Bearer <token>

file: <new_file.txt>
```

**ุงููุชูุฌุฉ:**
- ูุชู ุงุณุชุจุฏุงู ุงูููู ุงููุฏูู ุชููุงุฆูุงู
- ููุณ ุงูุงุณู ูุงููุณุงุฑ

### 2. ุชุญุฏูุซ ููู (ุงุณุชุจุฏุงู)

```http
PUT /api/files/:id/content
Content-Type: multipart/form-data
Authorization: Bearer <token>

file: <new_file.jpg>
replaceMode: true
```

**Response:**
```json
{
  "success": true,
  "message": "ุชู ุงุณุชุจุฏุงู ุงูููู ุจูุฌุงุญ (ููุณ ุงูุงุณู ูุงููุณุงุฑ)",
  "file": { ... },
  "replaceMode": true
}
```

### 3. ุชุญุฏูุซ ููู (ูุณุฎุฉ ุฌุฏูุฏุฉ)

```http
PUT /api/files/:id/content
Content-Type: multipart/form-data
Authorization: Bearer <token>

file: <new_file.jpg>
replaceMode: false
```

**Response:**
```json
{
  "success": true,
  "message": "ุชู ุชุญุฏูุซ ุงูููู ุจูุฌุงุญ (ูุณุฎุฉ ุฌุฏูุฏุฉ)",
  "file": { ... },
  "replaceMode": false
}
```

## ๐ ุชูุงุตูู ุชูููุฉ

### ุชุญุฏูุฏ ุงููููุงุช ุงููุตูุฉ

```javascript
const isTextFile = file.category === "Documents" || 
                   file.type?.startsWith("text/") ||
                   [".txt", ".md", ".json", ".xml", ".csv"].some(ext => 
                     file.name?.toLowerCase().endsWith(ext)
                   );
```

### ููุทู ุงูุงุณุชุจุฏุงู

```javascript
if (replaceMode) {
  // 1. ุญุฐู ุงูููู ุงููุฏูู
  fs.unlinkSync(oldFilePath);
  
  // 2. ูุณุฎ ุงูููู ุงูุฌุฏูุฏ ุฅูู ููุงู ุงููุฏูู
  fs.copyFileSync(newFilePath, oldFilePath);
  
  // 3. ุญุฐู ุงูููู ุงููุคูุช ุงูุฌุฏูุฏ
  fs.unlinkSync(newFilePath);
  
  // 4. ุงูุญูุงุธ ุนูู ููุณ ุงูุงุณู ูุงููุณุงุฑ
  file.path = oldFilePath;
  file.name = oldFileName;
} else {
  // ูุถุน ุงููุณุฎุฉ ุงูุฌุฏูุฏุฉ
  file.path = newFilePath;
  file.name = newFileName;
}
```

## โ๏ธ ุงูููุฒุงุช

- โ ุงุณุชุจุฏุงู ุชููุงุฆู ูููููุงุช ุงููุตูุฉ
- โ ุฎูุงุฑ ููุชุญูู ูู ูุถุน ุงูุงุณุชุจุฏุงู ูููููุงุช ุงูุฃุฎุฑู
- โ ุงูุญูุงุธ ุนูู ููุณ ุงูุงุณู ูุงููุณุงุฑ ุนูุฏ ุงูุงุณุชุจุฏุงู
- โ ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก ูุงูุชูุธูู
- โ ุชุญุฏูุซ ุญุฌู ุงููุฌูุฏ ุชููุงุฆูุงู
- โ ูุนุงูุฌุฉ ุงูููู ุงูุฌุฏูุฏ ูู ุงูุฎูููุฉ

## ๐ ุฃูุซูุฉ ุงูุงุณุชุฎุฏุงู

### Frontend - ุงุณุชุจุฏุงู ููู

```javascript
const formData = new FormData();
formData.append('file', newFile);
formData.append('replaceMode', 'true'); // ุฃู true

const response = await fetch(`/api/files/${fileId}/content`, {
  method: 'PUT',
  headers: {
    'Authorization': `Bearer ${token}`
  },
  body: formData
});

const data = await response.json();
// data.replaceMode = true
// data.file.name = ููุณ ุงูุงุณู ุงููุฏูู
// data.file.path = ููุณ ุงููุณุงุฑ ุงููุฏูู
```

### Frontend - ูุณุฎุฉ ุฌุฏูุฏุฉ

```javascript
const formData = new FormData();
formData.append('file', newFile);
formData.append('replaceMode', 'false'); // ุฃู ุนุฏู ุฅุฑุณุงูู

const response = await fetch(`/api/files/${fileId}/content`, {
  method: 'PUT',
  headers: {
    'Authorization': `Bearer ${token}`
  },
  body: formData
});

const data = await response.json();
// data.replaceMode = false
// data.file.name = ุงุณู ุฌุฏูุฏ (ูุน timestamp)
// data.file.path = ูุณุงุฑ ุฌุฏูุฏ
```

### Frontend - ููู ูุตู (ุงุณุชุจุฏุงู ุชููุงุฆู)

```javascript
const formData = new FormData();
formData.append('file', newTextFile); // .txt, .md, ุฅูุฎ

const response = await fetch(`/api/files/${fileId}/content`, {
  method: 'PUT',
  headers: {
    'Authorization': `Bearer ${token}`
  },
  body: formData
});

const data = await response.json();
// data.replaceMode = true (ุชููุงุฆูุงู)
// data.file.name = ููุณ ุงูุงุณู ุงููุฏูู
// data.file.path = ููุณ ุงููุณุงุฑ ุงููุฏูู
```

## โ๏ธ ููุงุญุธุงุช ูููุฉ

1. **ุงููููุงุช ุงููุตูุฉ:**
   - ูุชู ุงุณุชุจุฏุงููุง ุชููุงุฆูุงู ุฏุงุฆูุงู
   - ูุง ุญุงุฌุฉ ูุฅุฑุณุงู `replaceMode`

2. **ุงููููุงุช ุงูุฃุฎุฑู:**
   - ุชุญุชุงุฌ ุฅูู ุฅุฑุณุงู `replaceMode` ูู body
   - ุฅุฐุง ูู ูุชู ุฅุฑุณุงููุ ูุชู ุฅูุดุงุก ูุณุฎุฉ ุฌุฏูุฏุฉ

3. **ุงูุฃูุงู:**
   - ูุชู ุงูุชุญูู ูู ููููุฉ ุงูููู ูุจู ุงูุชุญุฏูุซ
   - ูุชู ุชูุธูู ุงููููุงุช ุงููุคูุชุฉ ูู ุญุงูุฉ ุงูุฎุทุฃ

4. **ุงูุฃุฏุงุก:**
   - ูู ูุถุน ุงูุงุณุชุจุฏุงูุ ูุชู ูุณุฎ ุงูููู ุฅูู ุงูููุงู ุงููุฏูู
   - ูู ูุถุน ุงููุณุฎุฉ ุงูุฌุฏูุฏุฉุ ุงูููู ูุจูู ูู ููุงูู ุงูุฌุฏูุฏ

## โ ุงูุชุญูู ูู ุงูุชุนุฏููุงุช

- โ ุชุนุฏูู ุฏุงูุฉ `updateFileContent`
- โ ุฅุถุงูุฉ ููุทู ุงูุงุณุชุจุฏุงู
- โ ุชุญุฏูุฏ ุงููููุงุช ุงููุตูุฉ ุชููุงุฆูุงู
- โ ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก ูุงูุชูุธูู
- โ ูุง ุชูุฌุฏ ุฃุฎุทุงุก ูู linter

## ๐ ุงููููุงุช ุงููุนุฏูุฉ

1. โ `services/fileService.js` - ุชุนุฏูู ุฏุงูุฉ `updateFileContent`

## ๐ ุงููุชูุฌุฉ

ุงูุขู:
- โ ุงููููุงุช ุงููุตูุฉ ูุชู ุงุณุชุจุฏุงููุง ุชููุงุฆูุงู ุจููุณ ุงูุงุณู ูุงููุณุงุฑ
- โ ุงููููุงุช ุงูุฃุฎุฑู ูููู ุงุฎุชูุงุฑ ูุถุน ุงูุงุณุชุจุฏุงู ุฃู ุงููุณุฎุฉ ุงูุฌุฏูุฏุฉ
- โ ุชุฌุฑุจุฉ ูุณุชุฎุฏู ุฃูุถู ูุฃูุซุฑ ูุฑููุฉ











